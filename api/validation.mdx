---
title: 'Request Validation'
description: 'Validate user requests with the Limitly API'
---

# Request Validation

The validation endpoint is the core feature of Limitly, allowing you to validate user requests in real-time.

## Validate Request

Validate a user's request using their API key:

```bash
curl -X POST \
  -H "Authorization: Bearer lk_1234567890abcdef1234567890abcdef" \
  -H "Content-Type: application/json" \
  -d '{
    "api_key": "user_api_key",
    "endpoint": "/api/users",
    "method": "GET"
  }' \
  https://api.limitly.com/v1/validate
```

### Request Parameters

<ParamField body="api_key" type="string" required>
  The user's API key to validate
</ParamField>

<ParamField body="endpoint" type="string" required>
  The endpoint being accessed
</ParamField>

<ParamField body="method" type="string" required>
  The HTTP method being used (GET, POST, PUT, DELETE, etc.)
</ParamField>

<ParamField body="metadata" type="object">
  Additional metadata for the request
</ParamField>

## Response

### Success Response

```json
{
  "success": true,
  "details": {
    "current_usage": 45,
    "limit": 1000,
    "remaining": 955,
    "reset_time": "2024-01-01T00:00:00Z"
  }
}
```

### Error Response

```json
{
  "success": false,
  "error": "Rate limit exceeded",
  "details": {
    "current_usage": 1000,
    "limit": 1000,
    "remaining": 0,
    "reset_time": "2024-01-01T00:00:00Z"
  }
}
```

## Response Fields

<ParamField body="success" type="boolean">
  Whether the request was allowed or denied
</ParamField>

<ParamField body="error" type="string">
  Error message if the request was denied
</ParamField>

<ParamField body="details" type="object">
  Additional details about the request and usage
</ParamField>

<ParamField body="details.current_usage" type="number">
  Current usage count for the period
</ParamField>

<ParamField body="details.limit" type="number">
  The limit for the current period
</ParamField>

<ParamField body="details.remaining" type="number">
  Remaining requests for the period
</ParamField>

<ParamField body="details.reset_time" type="string">
  When the usage will reset (ISO 8601 format)
</ParamField>

## Example Implementations

### JavaScript (Fetch)

```javascript
async function validateRequest(userApiKey, endpoint, method) {
  const response = await fetch('https://api.limitly.com/v1/validate', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${process.env.LIMITLY_API_KEY}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      api_key: userApiKey,
      endpoint: endpoint,
      method: method
    })
  });

  const result = await response.json();
  
  if (result.success) {
    console.log('Request allowed');
    console.log('Current usage:', result.details.current_usage);
    console.log('Limit:', result.details.limit);
  } else {
    console.log('Request denied:', result.error);
  }
  
  return result;
}
```

### Python (Requests)

```python
import requests
import os

def validate_request(user_api_key, endpoint, method):
    headers = {
        'Authorization': f'Bearer {os.getenv("LIMITLY_API_KEY")}',
        'Content-Type': 'application/json'
    }
    
    data = {
        'api_key': user_api_key,
        'endpoint': endpoint,
        'method': method
    }
    
    response = requests.post(
        'https://api.limitly.com/v1/validate',
        headers=headers,
        json=data
    )
    
    result = response.json()
    
    if result['success']:
        print('Request allowed')
        print('Current usage:', result['details']['current_usage'])
        print('Limit:', result['details']['limit'])
    else:
        print('Request denied:', result['error'])
    
    return result
```

### Express.js Middleware

```javascript
const express = require('express');
const fetch = require('node-fetch');

const app = express();

// Rate limiting middleware
app.use(async (req, res, next) => {
  const userApiKey = req.headers['x-api-key'];
  
  if (!userApiKey) {
    return res.status(401).json({ error: 'API key required' });
  }
  
  try {
    const response = await fetch('https://api.limitly.com/v1/validate', {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${process.env.LIMITLY_API_KEY}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        api_key: userApiKey,
        endpoint: req.path,
        method: req.method
      })
    });
    
    const result = await response.json();
    
    if (!result.success) {
      return res.status(429).json({ 
        error: result.error,
        details: result.details 
      });
    }
    
    // Add usage info to response headers
    res.set('X-RateLimit-Limit', result.details.limit.toString());
    res.set('X-RateLimit-Remaining', result.details.remaining.toString());
    res.set('X-RateLimit-Reset', result.details.reset_time);
    
    next();
  } catch (error) {
    console.error('Validation error:', error);
    return res.status(500).json({ error: 'Internal server error' });
  }
});
```

## Error Codes

| Code | Description |
|------|-------------|
| `INVALID_API_KEY` | The user's API key is invalid or expired |
| `RATE_LIMIT_EXCEEDED` | The user has exceeded their rate limit |
| `PLAN_NOT_FOUND` | The user's plan could not be found |
| `USER_NOT_FOUND` | The user could not be found |

## Best Practices

<CardGroup cols={1}>
  <Card title="Cache Validation Results">
    For high-traffic applications, consider caching validation results for a short period to reduce API calls.
  </Card>
</CardGroup>

<CardGroup cols={1}>
  <Card title="Handle Errors Gracefully">
    Always handle validation errors gracefully and provide meaningful error messages to your users.
  </Card>
</CardGroup>

<CardGroup cols={1}>
  <Card title="Include Usage Headers">
    Include usage information in your response headers to help clients track their usage.
  </Card>
</CardGroup>

## Next Steps

- [API Key Management](/api/api-keys) - Learn how to manage API keys
- [Plans](/api/plans) - Create and manage usage plans
- [Users](/api/users) - Manage user accounts and usage 